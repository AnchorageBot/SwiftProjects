Needs to be refactored and thoroughly checked for validity
