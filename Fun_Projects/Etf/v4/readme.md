v3 fully commented
