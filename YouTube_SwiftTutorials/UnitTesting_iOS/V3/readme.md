3rd Draft - Refactored and removed some code duplication
